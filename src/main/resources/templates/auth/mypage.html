<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지</title>
    <link rel="stylesheet" href="/static/css/deulmaru_const.css">
</head>
<body>

    <header th:replace="layout/header :: header"></header>

    <div class="container">
        <h1>마이페이지</h1>

        <!-- 로그인한 사용자 정보 -->
        <div class="user-info" th:if="${session.user != null}">
            <img th:src="${session.user.profileImage}" alt="프로필 이미지" width="100">
            <p><strong>아이디:</strong> <span th:text="${session.user.username}"></span></p>
            <p><strong>닉네임:</strong> <span th:text="${session.user.nickname}"></span></p>

            <!-- 회원정보 수정 폼 -->
            <h3>회원정보 수정</h3>
            <form action="/auth/update-profile" method="post">
                <label for="nickname">닉네임 변경:</label>
                <input type="text" id="nickname" name="nickname" th:value="${session.user.nickname}" required>

                <label for="password">비밀번호 변경:</label>
                <input type="password" id="password" name="password" placeholder="새 비밀번호 입력">

                <button type="submit">수정하기</button>
            </form>

            <!-- 카카오 연동 확인 및 버튼 -->
            <h3>카카오 계정 연동</h3>
            <div th:if="${session.user.kakaoId != null}">
                <p>현재 카카오 계정과 연동되어 있습니다.</p>
                <form action="/auth/kakao/unlink" method="post">
                    <button type="submit" class="btn-danger">카카오 연동 해제</button>
                </form>
            </div>
            <div th:if="${session.user.kakaoId == null}">
                <p>카카오 계정이 연동되지 않았습니다.</p>
                <a href="/auth/kakao/link" class="btn">카카오 계정 연동하기</a>
            </div>

            <!-- 로그아웃 버튼 -->
            <form action="/auth/logout" method="post">
                <button type="submit" class="btn-danger">로그아웃</button>
            </form>
        </div>

        <!-- 로그인 안 된 경우 -->
        <div th:if="${session.user == null}">
            <p>로그인이 필요합니다.</p>
            <a href="/auth/login" class="btn">로그인 페이지로 이동</a>
        </div>
    </div>

    <script src="/static/js/deulmaru_const.js"></script>
</body>
</html>
