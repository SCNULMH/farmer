<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>병해충 상세 정보</title>
    <link rel="stylesheet" href="/static/css/deulmaru_const.css">
</head>
<body>

    <header th:replace="layout/header :: header"></header>

    <div class="sick-detail-container">
        <h2 th:text="${sickNameKor}"></h2>
        <p><strong>병해충 설명:</strong> <span th:text="${symptoms}"></span></p>
        <p><strong>방제 방법:</strong> <span th:text="${preventionMethod}"></span></p>

        <div class="sick-images">
            <img th:each="image : ${imageList}" th:src="${image}" alt="병해충 이미지" width="150">
        </div>
    </div>

    <a href="/disease/search">← 검색으로 돌아가기</a>

</body>
	<script>
	document.addEventListener("DOMContentLoaded", function() {
	    let params = new URLSearchParams(window.location.search);
	    let sickKey = params.get("sick_key");

	    if (sickKey) {
	        fetch(`http://localhost:8082/api/sick_detail?sick_key=${sickKey}`)
	            .then(response => response.text())
	            .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
	            .then(data => {
	                let title = data.getElementsByTagName("sickNameKor")[0]?.textContent || "정보 없음";
	                let description = data.getElementsByTagName("symptoms")[0]?.textContent || "설명 없음";

	                document.getElementById("sickTitle").innerText = title;
	                document.getElementById("sickDescription").innerText = description;
	            });
	    }
	});
	</script>

</html>
